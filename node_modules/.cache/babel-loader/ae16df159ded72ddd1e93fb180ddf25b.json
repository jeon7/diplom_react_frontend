{"ast":null,"code":"import _defineProperty from \"/Users/GK/Documents/WEB/diplom/eco_kitchen/react_frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _taggedTemplateLiteral from \"/Users/GK/Documents/WEB/diplom/eco_kitchen/react_frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";\nvar _jsxFileName = \"/Users/GK/Documents/WEB/diplom/eco_kitchen/react_frontend/src/components/shopping/Shopping.js\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(source, true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(source).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _templateObject8() {\n  const data = _taggedTemplateLiteral([\"\\n  border-radius: 4px;\\n  font-size: 1.5rem;\\n  text-align: center;\\n  padding: 0.25rem 1rem;\\n  color: black;\\n  outline: none;\\n  margin: 0.2rem;\\n\"]);\n\n  _templateObject8 = function () {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject7() {\n  const data = _taggedTemplateLiteral([\"\\n  border: none;\\n  border-radius: 4px;\\n  font-size: 1rem;\\n  padding: 0.25rem 1rem;\\n  color: white;\\n  outline: none;\\n  cursor: pointer;\\n  background: #90C3E5;\\n  margin: 0.2rem;\\n\"]);\n\n  _templateObject7 = function () {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject6() {\n  const data = _taggedTemplateLiteral([\"\\n  height: 2.125rem;\\n  width: 30%;\\n  text-align: center;\\n  margin: 1rem 1rem 1rem 1rem;\\n  & + & {\\n    margin-left: 0.5rem;\\n  }\\n\"]);\n\n  _templateObject6 = function () {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject5() {\n  const data = _taggedTemplateLiteral([\"\\n  margin: 1rem 1rem 1rem 1rem;\\n  clear: both;\\n  align-self: center;\\n  width: 95%;\\n  min-height: 15rem;\\n\"]);\n\n  _templateObject5 = function () {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject4() {\n  const data = _taggedTemplateLiteral([\"\\n  margin-top: 1rem;\\n  margin-bottom: 3rem;\\n  display: flex;\\n  align-items: center;\\n  justify-content: center;\\n  width: 95%;\\n\"]);\n\n  _templateObject4 = function () {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject3() {\n  const data = _taggedTemplateLiteral([\"\\n  float: right;\\n  width: 48%;\\n  min-height: 15rem;\\n  margin-left: 0.3rem;\\n  background-color: whitesmoke;\\n\"]);\n\n  _templateObject3 = function () {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject2() {\n  const data = _taggedTemplateLiteral([\"\\n  float: left;\\n  width: 48%;\\n  height: auto;\\n  min-height: 15rem;\\n  margin-right: 0.3rem;\\n  background-color: whitesmoke;\\n\"]);\n\n  _templateObject2 = function () {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject() {\n  const data = _taggedTemplateLiteral([\"\\n  /* position: fixed; */\\n  /* display: flex; */\\n  display: block;\\n  width: 95%;\\n  /* height: 100%; */\\n  background-color: lightgray;\\n  margin-left: 0.5rem;\\n  margin-right: 0.5rem;\\n  margin-top: 0.5rem;\\n  margin-bottom: 0.5rem;\\n\"]);\n\n  _templateObject = function () {\n    return data;\n  };\n\n  return data;\n}\n\nimport React, { Component } from 'react';\nimport styled from 'styled-components';\nimport Button from '../common/Button';\nconst ShoppingBlock = styled.div(_templateObject());\nconst BookmarksZone = styled.div(_templateObject2());\nconst ShoppingCartZone = styled.div(_templateObject3());\nconst CalculateBlock = styled.div(_templateObject4());\nconst CalculatedResultBox = styled.textarea(_templateObject5());\n/* TagBox에서 사용하는 버튼과 일치하는 높이로 설정 후 서로 간의 여백 지정 */\n\nconst CalculateButton = styled(Button)(_templateObject6());\nconst Item = styled.div(_templateObject7());\nconst DescHeader = styled.div(_templateObject8());\n\nclass Shopping extends Component {\n  constructor(props) {\n    super(props);\n\n    this.onDragStart = (ev, noteId) => {\n      console.log('onDragStart: ', noteId);\n      ev.dataTransfer.setData(\"noteId\", noteId);\n      return true;\n    };\n\n    this.onDragOver = ev => {\n      ev.preventDefault();\n    };\n\n    this.onDrop = (ev, cat) => {\n      ev.preventDefault();\n      ev.stopPropagation();\n      console.log('onDrop: '); // Check Prompt\n\n      const cookingPortion = prompt(\"Please enter cooking portion\", \"4\");\n\n      if (cookingPortion === null || cookingPortion === \"\") {\n        return;\n      } else {\n        let noteId = ev.dataTransfer.getData(\"noteId\");\n        console.log('noteId: ', noteId); // change attribute zone to shoppingCartZone from bookmarkedZone\n\n        let nextBookmarkedNotes = this.state.bookmarkedNotes.filter(note => {\n          if (note._id === noteId) {\n            note.zone = cat;\n          }\n\n          return note;\n        });\n        this.setState(_objectSpread({}, this.state, {\n          bookmarkedNotes: nextBookmarkedNotes\n        })); // add attribute cookingPortion \n\n        console.log(\"cookingPortion: \", cookingPortion);\n        let nextBookmarkedNotes2 = this.state.bookmarkedNotes.filter(note => {\n          if (note._id === noteId) {\n            note.cookingPortion = cookingPortion;\n          }\n\n          return note;\n        });\n        this.setState(_objectSpread({}, this.state, {\n          bookmarkedNotes: nextBookmarkedNotes2\n        }));\n        console.log(\"bookmarkedNotes after adding portion: \", this.state.bookmarkedNotes);\n      }\n\n      return false;\n    };\n\n    this.onCalculateClick = () => {\n      let shoppingCartObjArray = [];\n      this.state.bookmarkedNotes.filter(note => {\n        if (note.zone === 'shoppingCartZone') {\n          shoppingCartObjArray.push(note);\n        }\n\n        return note;\n      });\n      console.log(\"shoppingCartObjArray: \", shoppingCartObjArray); // get meaningful data for calculation from shoppingCartObjArray\n\n      let shoppingDataObjArray = [];\n      shoppingCartObjArray.forEach(shoppingCartObj => {\n        let shoppingDataObj = {};\n        shoppingDataObj.portionWeight = parseFloat(shoppingCartObj.cookingPortion) / parseFloat(shoppingCartObj.standardPortion);\n        shoppingDataObj.ingredients = shoppingCartObj.ingredients;\n        shoppingDataObjArray.push(shoppingDataObj);\n      });\n      console.log(\"shoppingDataObjArray: \", shoppingDataObjArray); // get all Ingredients with amount calculated\n\n      let allIngredientsWithWeightedAmount = [];\n      shoppingDataObjArray.forEach(shoppingDataObj => {\n        let ingredientsArray = shoppingDataObj.ingredients.split(';');\n        let ingredientsArrayTrimed = [];\n        ingredientsArray.forEach(ingredient => {\n          ingredientsArrayTrimed.push(ingredient.trim());\n        });\n        console.log(ingredientsArrayTrimed); //string array [\"fruit, banana, 100, g\", \"fruit, apple, 200, g\", ...]\n\n        ingredientsArrayTrimed.forEach(ingredientTrimed => {\n          let ingredientsElementArray = ingredientTrimed.split(',');\n          console.log(\"ingredientsElementArray before portion weight apply: \", ingredientsElementArray); // string array [\"fruit\", \"banana\", \"100\", \"g\"]\n\n          let amount = parseFloat(ingredientsElementArray[2]);\n          console.log(\"amount: \", amount);\n          console.log(\"shoppingDataObj.portionWeight: \", shoppingDataObj.portionWeight);\n          let portionAmount = amount * shoppingDataObj.portionWeight;\n          console.log(\"portionAmount: \", portionAmount);\n          ingredientsElementArray.splice(2, 1, portionAmount);\n          console.log(\"ingredientsElementArray after portion weight apply: \", ingredientsElementArray); // mixed array [\"fruit\", \"banana\", 200, \"g\"]\n\n          allIngredientsWithWeightedAmount.push(ingredientsElementArray);\n        });\n      }); // this console.log allIngredientsWithWeightedAmount value is affected by next algorithm \n\n      console.log(\"allIngredientsWithWeightedAmount: \", allIngredientsWithWeightedAmount); // should be array of mixed array\n      // grouping same ingredients\n\n      let ingredients = allIngredientsWithWeightedAmount.concat(); // change to short name \n\n      let sameIngredientGroup = [];\n      let skipIndex = [];\n      let calculatedResult = [];\n\n      for (let i = 0; i < ingredients.length; i++) {\n        let sameIngredientIndex = [];\n\n        if (!skipIndex.includes(i)) {\n          let amount = 0;\n\n          for (let j = 0; j < ingredients.length; j++) {\n            if (ingredients[i][1] === ingredients[j][1]) {\n              sameIngredientIndex.push(j);\n              skipIndex.push(j); // console.log(\"ingredients[j][2]: \", ingredients[j][2]);\n\n              amount = amount + ingredients[j][2];\n            } // console.log(\"amount: \", amount);\n\n          }\n\n          sameIngredientIndex.push(amount);\n          sameIngredientGroup.push(sameIngredientIndex); // amount 소수 둘째 자리 까지만 표시\n\n          const newAmount = amount.toFixed(2);\n          console.log(\"newAmount: \", newAmount); // 계산된 amount 값으로 교체 \n\n          ingredients[sameIngredientIndex[0]].splice(2, 1, newAmount);\n          calculatedResult.push(ingredients[sameIngredientIndex[0]]);\n        }\n      }\n\n      console.log(sameIngredientGroup);\n      console.log(calculatedResult);\n      let strIngredientsArray = [];\n      calculatedResult.forEach(calculatedIngredient => {\n        strIngredientsArray.push(calculatedIngredient.join(' '));\n      });\n      strIngredientsArray.sort();\n      console.log(strIngredientsArray);\n      let strIngredients = strIngredientsArray.join('\\n');\n      console.log(strIngredients);\n      this.setState(_objectSpread({}, this.state, {\n        calculatedResultStr: strIngredients\n      })); // alert(strIngredients);\n    };\n\n    this.state = {\n      bookmarkedNotes: null,\n      calculatedResultStr: 'hi hi'\n    };\n  }\n\n  static getDerivedStateFromProps(nextProps, prevState) {\n    console.log('getDerivedStateFromProps() called'); // get first props from ShoppingContainer\n\n    if (!prevState.bookmarkedNotes && prevState.bookmarkedNotes !== nextProps.bookmarkedNotes) {\n      console.log('!prevState.bookmarkedNotes && (prevState.bookmarkedNotes !== nextProps.bookmarkedNotes');\n      console.log(nextProps.bookmarkedNotes);\n      console.log(prevState.bookmarkedNotes);\n\n      if (nextProps.bookmarkedNotes) {\n        nextProps.bookmarkedNotes.forEach(note => {\n          note.zone = 'bookmarkedZone';\n        });\n        console.log('Shopping.js-nextProps.bookmarkedNotes after forEach: ', nextProps.bookmarkedNotes);\n      }\n\n      return {\n        bookmarkedNotes: nextProps.bookmarkedNotes\n      };\n    }\n\n    return null;\n  }\n\n  render() {\n    let noteZone = {\n      bookmarkedZone: [],\n      shoppingCartZone: []\n    };\n\n    if (this.state.bookmarkedNotes) {\n      this.state.bookmarkedNotes.forEach(note => {\n        noteZone[note.zone].push(React.createElement(Item, {\n          draggable: true,\n          noteId: note._id,\n          key: note._id,\n          onDragStart: e => this.onDragStart(e, note._id),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 275\n          },\n          __self: this\n        }, note.title));\n      });\n    }\n\n    return React.createElement(React.Fragment, null, React.createElement(ShoppingBlock, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 288\n      },\n      __self: this\n    }, React.createElement(BookmarksZone, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 289\n      },\n      __self: this\n    }, React.createElement(DescHeader, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 290\n      },\n      __self: this\n    }, \" bookmarked notes: drag to shopping cart \"), noteZone.bookmarkedZone), React.createElement(ShoppingCartZone, {\n      onDragOver: e => this.onDragOver(e),\n      onDrop: e => this.onDrop(e, \"shoppingCartZone\"),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 293\n      },\n      __self: this\n    }, React.createElement(DescHeader, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 297\n      },\n      __self: this\n    }, \" shopping cart: drop here \"), noteZone.shoppingCartZone)), React.createElement(CalculateBlock, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 301\n      },\n      __self: this\n    }, React.createElement(CalculatedResultBox, {\n      value: this.state.calculatedResultStr,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 302\n      },\n      __self: this\n    }), React.createElement(CalculateButton, {\n      onClick: this.onCalculateClick,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 303\n      },\n      __self: this\n    }, \"Calculate\")));\n  }\n\n}\n\nexport default Shopping;","map":{"version":3,"sources":["/Users/GK/Documents/WEB/diplom/eco_kitchen/react_frontend/src/components/shopping/Shopping.js"],"names":["React","Component","styled","Button","ShoppingBlock","div","BookmarksZone","ShoppingCartZone","CalculateBlock","CalculatedResultBox","textarea","CalculateButton","Item","DescHeader","Shopping","constructor","props","onDragStart","ev","noteId","console","log","dataTransfer","setData","onDragOver","preventDefault","onDrop","cat","stopPropagation","cookingPortion","prompt","getData","nextBookmarkedNotes","state","bookmarkedNotes","filter","note","_id","zone","setState","nextBookmarkedNotes2","onCalculateClick","shoppingCartObjArray","push","shoppingDataObjArray","forEach","shoppingCartObj","shoppingDataObj","portionWeight","parseFloat","standardPortion","ingredients","allIngredientsWithWeightedAmount","ingredientsArray","split","ingredientsArrayTrimed","ingredient","trim","ingredientTrimed","ingredientsElementArray","amount","portionAmount","splice","concat","sameIngredientGroup","skipIndex","calculatedResult","i","length","sameIngredientIndex","includes","j","newAmount","toFixed","strIngredientsArray","calculatedIngredient","join","sort","strIngredients","calculatedResultStr","getDerivedStateFromProps","nextProps","prevState","render","noteZone","bookmarkedZone","shoppingCartZone","e","title"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport styled from 'styled-components';\nimport Button from '../common/Button';\n\n\nconst ShoppingBlock = styled.div`\n  /* position: fixed; */\n  /* display: flex; */\n  display: block;\n  width: 95%;\n  /* height: 100%; */\n  background-color: lightgray;\n  margin-left: 0.5rem;\n  margin-right: 0.5rem;\n  margin-top: 0.5rem;\n  margin-bottom: 0.5rem;\n`;\n\nconst BookmarksZone = styled.div`\n  float: left;\n  width: 48%;\n  height: auto;\n  min-height: 15rem;\n  margin-right: 0.3rem;\n  background-color: whitesmoke;\n`;\nconst ShoppingCartZone = styled.div`\n  float: right;\n  width: 48%;\n  min-height: 15rem;\n  margin-left: 0.3rem;\n  background-color: whitesmoke;\n`;\n\nconst CalculateBlock = styled.div`\n  margin-top: 1rem;\n  margin-bottom: 3rem;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 95%;\n`;\n\nconst CalculatedResultBox = styled.textarea`\n  margin: 1rem 1rem 1rem 1rem;\n  clear: both;\n  align-self: center;\n  width: 95%;\n  min-height: 15rem;\n`;\n\n/* TagBox에서 사용하는 버튼과 일치하는 높이로 설정 후 서로 간의 여백 지정 */\nconst CalculateButton = styled(Button)`\n  height: 2.125rem;\n  width: 30%;\n  text-align: center;\n  margin: 1rem 1rem 1rem 1rem;\n  & + & {\n    margin-left: 0.5rem;\n  }\n`;\n\nconst Item = styled.div`\n  border: none;\n  border-radius: 4px;\n  font-size: 1rem;\n  padding: 0.25rem 1rem;\n  color: white;\n  outline: none;\n  cursor: pointer;\n  background: #90C3E5;\n  margin: 0.2rem;\n`;\n\nconst DescHeader = styled.div`\n  border-radius: 4px;\n  font-size: 1.5rem;\n  text-align: center;\n  padding: 0.25rem 1rem;\n  color: black;\n  outline: none;\n  margin: 0.2rem;\n`;\n\nclass Shopping extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      bookmarkedNotes: null,\n      calculatedResultStr: 'hi hi'\n    }\n  }\n\n  static getDerivedStateFromProps(nextProps, prevState) {\n    console.log('getDerivedStateFromProps() called');\n    // get first props from ShoppingContainer\n    if (!prevState.bookmarkedNotes && (prevState.bookmarkedNotes !== nextProps.bookmarkedNotes)) {\n      console.log('!prevState.bookmarkedNotes && (prevState.bookmarkedNotes !== nextProps.bookmarkedNotes');\n      console.log(nextProps.bookmarkedNotes);\n      console.log(prevState.bookmarkedNotes);\n\n      if (nextProps.bookmarkedNotes) {\n        nextProps.bookmarkedNotes.forEach((note) => {\n          note.zone = 'bookmarkedZone';\n        });\n        console.log('Shopping.js-nextProps.bookmarkedNotes after forEach: ', nextProps.bookmarkedNotes);\n      }\n      return { bookmarkedNotes: nextProps.bookmarkedNotes };\n    }\n    return null;\n  }\n\n\n  onDragStart = (ev, noteId) => {\n    console.log('onDragStart: ', noteId);\n    ev.dataTransfer.setData(\"noteId\", noteId);\n    return true;\n  }\n\n  onDragOver = ev => {\n    ev.preventDefault();\n  }\n\n\n  onDrop = (ev, cat) => {\n    ev.preventDefault();\n    ev.stopPropagation();\n    console.log('onDrop: ');\n\n    // Check Prompt\n    const cookingPortion = prompt(\"Please enter cooking portion\", \"4\");\n    if (cookingPortion === null || cookingPortion === \"\") {\n      return;\n    } else {\n\n      let noteId = ev.dataTransfer.getData(\"noteId\");\n      console.log('noteId: ', noteId);\n\n      // change attribute zone to shoppingCartZone from bookmarkedZone\n      let nextBookmarkedNotes = this.state.bookmarkedNotes.filter((note) => {\n        if (note._id === noteId) {\n          note.zone = cat;\n        }\n        return note;\n      });\n      this.setState({\n        ...this.state,\n        bookmarkedNotes: nextBookmarkedNotes\n      });\n\n      // add attribute cookingPortion \n      console.log(\"cookingPortion: \", cookingPortion);\n      let nextBookmarkedNotes2 = this.state.bookmarkedNotes.filter((note) => {\n        if (note._id === noteId) {\n          note.cookingPortion = cookingPortion;\n        }\n        return note;\n      });\n      this.setState({\n        ...this.state,\n        bookmarkedNotes: nextBookmarkedNotes2\n      });\n      console.log(\"bookmarkedNotes after adding portion: \", this.state.bookmarkedNotes);\n    }\n    return false;\n  }\n\n  onCalculateClick = () => {\n    let shoppingCartObjArray = [];\n    this.state.bookmarkedNotes.filter((note) => {\n      if (note.zone === 'shoppingCartZone') {\n        shoppingCartObjArray.push(note);\n      }\n      return note;\n    });\n    console.log(\"shoppingCartObjArray: \", shoppingCartObjArray);\n\n    // get meaningful data for calculation from shoppingCartObjArray\n    let shoppingDataObjArray = [];\n    shoppingCartObjArray.forEach((shoppingCartObj) => {\n      let shoppingDataObj = {};\n      shoppingDataObj.portionWeight = parseFloat(shoppingCartObj.cookingPortion) / parseFloat(shoppingCartObj.standardPortion);\n      shoppingDataObj.ingredients = shoppingCartObj.ingredients;\n      shoppingDataObjArray.push(shoppingDataObj);\n    });\n    console.log(\"shoppingDataObjArray: \", shoppingDataObjArray);\n\n    // get all Ingredients with amount calculated\n    let allIngredientsWithWeightedAmount = [];\n    shoppingDataObjArray.forEach((shoppingDataObj) => {\n      let ingredientsArray = shoppingDataObj.ingredients.split(';');\n      let ingredientsArrayTrimed = [];\n      ingredientsArray.forEach((ingredient) => {\n        ingredientsArrayTrimed.push(ingredient.trim());\n      });\n      console.log(ingredientsArrayTrimed) //string array [\"fruit, banana, 100, g\", \"fruit, apple, 200, g\", ...]\n\n      ingredientsArrayTrimed.forEach((ingredientTrimed) => {\n        let ingredientsElementArray = ingredientTrimed.split(',');\n        console.log(\"ingredientsElementArray before portion weight apply: \", ingredientsElementArray); // string array [\"fruit\", \"banana\", \"100\", \"g\"]\n        let amount = parseFloat(ingredientsElementArray[2]);\n        console.log(\"amount: \", amount);\n        console.log(\"shoppingDataObj.portionWeight: \", shoppingDataObj.portionWeight);\n        let portionAmount = amount * shoppingDataObj.portionWeight;\n        console.log(\"portionAmount: \", portionAmount);\n\n        ingredientsElementArray.splice(2, 1, portionAmount);\n        console.log(\"ingredientsElementArray after portion weight apply: \", ingredientsElementArray); // mixed array [\"fruit\", \"banana\", 200, \"g\"]\n        allIngredientsWithWeightedAmount.push(ingredientsElementArray);\n      });\n    });\n    // this console.log allIngredientsWithWeightedAmount value is affected by next algorithm \n    console.log(\"allIngredientsWithWeightedAmount: \", allIngredientsWithWeightedAmount); // should be array of mixed array\n\n\n    // grouping same ingredients\n    let ingredients = allIngredientsWithWeightedAmount.concat(); // change to short name \n    let sameIngredientGroup = [];\n    let skipIndex = [];\n    let calculatedResult = [];\n    for (let i = 0; i < ingredients.length; i++) {\n      let sameIngredientIndex = [];\n      if (!skipIndex.includes(i)) {\n        let amount = 0;\n        for (let j = 0; j < ingredients.length; j++) {\n          if (ingredients[i][1] === ingredients[j][1]) {\n            sameIngredientIndex.push(j);\n            skipIndex.push(j);\n            // console.log(\"ingredients[j][2]: \", ingredients[j][2]);\n            amount = amount + ingredients[j][2];\n          }\n          // console.log(\"amount: \", amount);\n        }\n        sameIngredientIndex.push(amount);\n        sameIngredientGroup.push(sameIngredientIndex);\n        // amount 소수 둘째 자리 까지만 표시\n        const newAmount = amount.toFixed(2);\n        console.log(\"newAmount: \", newAmount);\n        // 계산된 amount 값으로 교체 \n        ingredients[sameIngredientIndex[0]].splice(2, 1, newAmount);\n        calculatedResult.push(ingredients[sameIngredientIndex[0]]);\n      }\n    }\n    console.log(sameIngredientGroup);\n    console.log(calculatedResult);\n\n    let strIngredientsArray = [];\n    calculatedResult.forEach((calculatedIngredient) => {\n      strIngredientsArray.push(calculatedIngredient.join(' '));\n    });\n    strIngredientsArray.sort();\n    console.log(strIngredientsArray);\n    let strIngredients = strIngredientsArray.join('\\n');\n    console.log(strIngredients);\n\n    this.setState({\n      ...this.state,\n      calculatedResultStr: strIngredients\n    });\n\n    // alert(strIngredients);\n  }\n\n\n  render() {\n    let noteZone = {\n      bookmarkedZone: [],\n      shoppingCartZone: []\n    };\n\n    if (this.state.bookmarkedNotes) {\n      this.state.bookmarkedNotes.forEach((note) => {\n        noteZone[note.zone].push(\n          <Item\n            draggable={true}\n            noteId={note._id}\n            key={note._id}\n            onDragStart={(e) => this.onDragStart(e, note._id)}>\n            {note.title}\n          </Item>\n        );\n      })\n    }\n\n    return (\n      <>\n        <ShoppingBlock>\n          <BookmarksZone>\n            <DescHeader> bookmarked notes: drag to shopping cart </DescHeader>\n            {noteZone.bookmarkedZone}\n          </BookmarksZone>\n          <ShoppingCartZone\n            onDragOver={(e) => this.onDragOver(e)}\n            onDrop={(e) => this.onDrop(e, \"shoppingCartZone\")}\n          >\n            <DescHeader> shopping cart: drop here </DescHeader>\n            {noteZone.shoppingCartZone}\n          </ShoppingCartZone>\n        </ShoppingBlock>\n        <CalculateBlock>\n          <CalculatedResultBox value={this.state.calculatedResultStr} />\n          <CalculateButton onClick={this.onCalculateClick}>\n            Calculate\n          </CalculateButton>\n        </CalculateBlock>\n      </>\n    );\n  }\n}\n\nexport default Shopping;\n"]},"metadata":{},"sourceType":"module"}